!function(l){function a(l){return plupload.translate(l)||l}function e(e,d){d.contents().each(function(a,e){e=l(e),e.is(".plupload")||e.remove()}),d.prepend('<div class="plupload_wrapper plupload_scroll"><div id="'+e+'_container" class="plupload_container"><div class="plupload"><div class="plupload_header"><div class="plupload_header_content"><div class="plupload_header_title">'+a("Select files")+'</div><div class="plupload_header_text">'+a("Add files to the upload queue and click the start button.")+'</div></div></div><div class="plupload_content"><div class="plupload_filelist_header"><div class="plupload_file_name">'+a("Filename")+'</div><div class="plupload_file_action">&nbsp;</div><div class="plupload_file_status"><span>'+a("Status")+'</span></div><div class="plupload_file_size">'+a("Size")+'</div><div class="plupload_clearer">&nbsp;</div></div><ul id="'+e+'_filelist" class="plupload_filelist"></ul><div class="plupload_filelist_footer"><div class="plupload_file_name"><div class="plupload_buttons"><a href="#" class="plupload_button plupload_add buttonS bDefault">'+a("Add files")+'</a><a href="#" class="plupload_button plupload_start buttonS bRed">'+a("Start upload")+'</a><div class="clear"></div></div><span class="plupload_upload_status"></span></div><div class="plupload_file_action"></div><div class="plupload_file_status"><span class="plupload_total_status">0%</span></div><div class="plupload_file_size"><span class="plupload_total_file_size">0 b</span></div><div class="plupload_progress"><div class="plupload_progress_container"><div class="plupload_progress_bar"></div></div></div><div class="plupload_clearer">&nbsp;</div></div></div></div></div><input type="hidden" id="'+e+'_count" name="'+e+'_count" value="0" /></div>')}var d={};l.fn.pluploadQueue=function(t){return t?(this.each(function(){function p(a){var e;a.status==plupload.DONE&&(e="plupload_done"),a.status==plupload.FAILED&&(e="plupload_failed"),a.status==plupload.QUEUED&&(e="plupload_delete"),a.status==plupload.UPLOADING&&(e="plupload_uploading");var d=l("#"+a.id).attr("class",e).find("a").css("display","block");a.hint&&d.attr("title",a.hint)}function s(){l("span.plupload_total_status",u).html(o.total.percent+"%"),l("div.plupload_progress_bar",u).css("width",o.total.percent+"%"),l("span.plupload_upload_status",u).text(a("Uploaded %d/%d files").replace(/%d\/%d/,o.total.uploaded+"/"+o.files.length))}function i(){var e,d=l("ul.plupload_filelist",u).html(""),t=0;l.each(o.files,function(a,s){e="",s.status==plupload.DONE&&(s.target_name&&(e+='<input type="hidden" name="'+n+"_"+t+'_tmpname" value="'+plupload.xmlEncode(s.target_name)+'" />'),e+='<input type="hidden" name="'+n+"_"+t+'_name" value="'+plupload.xmlEncode(s.name)+'" />',e+='<input type="hidden" name="'+n+"_"+t+'_status" value="'+(s.status==plupload.DONE?"done":"failed")+'" />',t++,l("#"+n+"_count").val(t)),d.append('<li id="'+s.id+'"><div class="plupload_file_name"><span>'+s.name+'</span></div><div class="plupload_file_action"><a href="#"></a></div><div class="plupload_file_status">'+s.percent+'%</div><div class="plupload_file_size">'+plupload.formatSize(s.size)+'</div><div class="plupload_clearer">&nbsp;</div>'+e+"</li>"),p(s),l("#"+s.id+".plupload_delete a").click(function(a){l("#"+s.id).remove(),o.removeFile(s),a.preventDefault()})}),l("span.plupload_total_file_size",u).html(plupload.formatSize(o.total.size)),0===o.total.queued?l("span.plupload_add_text",u).text(a("Add files.")):l("span.plupload_add_text",u).text(o.total.queued+" files queued."),l("a.plupload_start",u).toggleClass("plupload_disabled",o.files.length==o.total.uploaded+o.total.failed),d[0].scrollTop=d[0].scrollHeight,s(),!o.files.length&&o.features.dragdrop&&o.settings.dragdrop&&l("#"+n+"_filelist").append('<li class="plupload_droptext">'+a("Drag files here.")+"</li>")}var o,u,n;u=l(this),n=u.attr("id"),n||(n=plupload.guid(),u.attr("id",n)),o=new plupload.Uploader(l.extend({dragdrop:!0,container:n},t)),d[n]=o,o.bind("UploadFile",function(a,e){l("#"+e.id).addClass("plupload_current_file")}),o.bind("Init",function(d,p){e(n,u),!t.unique_names&&t.rename&&l("#"+n+"_filelist div.plupload_file_name span",u).live("click",function(a){var e,t,p,s=l(a.target),i="";e=d.getFile(s.parents("li")[0].id),p=e.name,t=/^(.+)(\.[^.]+)$/.exec(p),t&&(p=t[1],i=t[2]),s.hide().after('<input type="text" />'),s.next().val(p).focus().blur(function(){s.show().next().remove()}).keydown(function(a){var d=l(this);13==a.keyCode&&(a.preventDefault(),e.name=d.val()+i,s.text(e.name),d.blur())})}),l("a.plupload_add",u).attr("id",n+"_browse"),d.settings.browse_button=n+"_browse",d.features.dragdrop&&d.settings.dragdrop&&(d.settings.drop_element=n+"_filelist",l("#"+n+"_filelist").append('<li class="plupload_droptext">'+a("Drag files here.")+"</li>")),l("#"+n+"_container").attr("title","Using runtime: "+p.runtime),l("a.plupload_start",u).click(function(a){l(this).hasClass("plupload_disabled")||o.start(),a.preventDefault()}),l("a.plupload_stop",u).click(function(l){l.preventDefault(),o.stop()}),l("a.plupload_start",u).addClass("plupload_disabled")}),o.init(),o.bind("Error",function(e,d){var t,p=d.file;p&&(t=d.message,d.details&&(t+=" ("+d.details+")"),d.code==plupload.FILE_SIZE_ERROR&&alert(a("Error: File too large: ")+p.name),d.code==plupload.FILE_EXTENSION_ERROR&&alert(a("Error: Invalid file extension: ")+p.name),p.hint=t,l("#"+p.id).attr("class","plupload_failed").find("a").css("display","block").attr("title",t))}),o.bind("StateChanged",function(){o.state===plupload.STARTED?(l("li.plupload_delete a,div.plupload_buttons",u).hide(),l("span.plupload_upload_status,div.plupload_progress,a.plupload_stop",u).css("display","block"),l("span.plupload_upload_status",u).text("Uploaded "+o.total.uploaded+"/"+o.files.length+" files"),t.multiple_queues&&l("span.plupload_total_status,span.plupload_total_file_size",u).show()):(i(),l("a.plupload_stop,div.plupload_progress",u).hide(),l("a.plupload_delete",u).css("display","block"))}),o.bind("QueueChanged",i),o.bind("FileUploaded",function(l,a){p(a)}),o.bind("UploadProgress",function(a,e){l("#"+e.id+" div.plupload_file_status",u).html(e.percent+"%"),p(e),s(),t.multiple_queues&&o.total.uploaded+o.total.failed==o.files.length&&(l(".plupload_buttons,.plupload_upload_status",u).css("display","inline"),l(".plupload_start",u).addClass("plupload_disabled"),l("span.plupload_total_status,span.plupload_total_file_size",u).hide())}),t.setup&&t.setup(o)}),this):d[l(this[0]).attr("id")]}}(jQuery);